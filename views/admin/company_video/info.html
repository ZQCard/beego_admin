<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-card-header">{{.Title}}</div>
        <div class="layui-card-body" style="padding: 15px;">
            <form class="layui-form" action="/video" {{if eq 0 .Video.ID}}id="AddForm"{{else}}id="EditForm{{.Video.ID}}"{{end}}>
                {{if ne 0 .Video.ID}}
                    <input type="hidden" name="_method" value="PUT">
                    <input type="hidden" name="id" value="{{.Video.ID}}">

                {{end}}
                <div class="layui-form-item">
                    <label class="layui-form-label">视频标题</label>
                    <div class="layui-input-block">
                        <input type="text" name="title" lay-verify="title" autocomplete="off" value="{{.Video.Title}}" placeholder="请输入标题" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">视频上传</label>
                    <button type="button" class="layui-btn" id="upload_video">上传视频</button><input class="layui-upload-file" type="file" accept="undefined" name="file">
                    <input type="hidden" name="url" value="{{.Video.Url}}">
                    <div class="layui-upload-list" {{if .Video.ID|not}}style="display: none"{{end}}>
                        <img width="20%" height="50%" class="layui-upload-video" src="{{.Video.Url}}" id="upload_video_url">
                    </div>
                </div>


                <div class="layui-form-item">
                    <label class="layui-form-label">视频分类</label>
                    <div class="layui-input-block">
                        <select name="company_video_category_id">
                            <option value="0">请选择</option>
                            {{range .Categories}}
                                <option value="{{.ID}}" {{if eq .ID $.Video.CompanyVideoCategoryId}}selected{{end}}>{{.Name}}</option>
                            {{end}}
                        </select>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">首页展示</label>
                    <div class="layui-input-block">
                        <input type="radio" name="is_show_home_page" value="1" title="展示" {{if eq 1 .Video.IsShowHomePage}}checked{{end}}>
                        <input type="radio" name="is_show_home_page" value="0" title="不展示" {{if eq 0 .Video.IsShowHomePage}}checked{{end}}>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">是否上架</label>
                    <div class="layui-input-block">
                        <input type="radio" name="is_on_sale" value="1" title="上架" {{if eq 1 .Video.IsOnSale}}checked{{end}}>
                        <input type="radio" name="is_on_sale" value="0" title="下架" {{if eq 0 .Video.IsOnSale}}checked{{end}}>
                    </div>
                </div>
                <div class="layui-form-item layui-form-text">
                    <label class="layui-form-label">视频描述</label>
                    <div class="layui-input-block">
                        <textarea name="description" placeholder="请输入内容" class="layui-textarea">{{.Video.Description}}</textarea>
                    </div>
                </div>
                <div class="layui-form-item layui-layout-admin">
                    <div class="layui-input-block">
                        <div class="layui-footer" style="left: 0;">
                            <a class="layui-btn EditFormSubmit" {{if eq 0 .Video.ID}}id="AddFormSubmit"{{else}}id="EditForm{{.Video.ID}}" data-form_id="EditForm{{.Video.ID}}"{{end}}>立即提交</a>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    layui.use('upload', function(){
        var upload = layui.upload;

        //执行实例
        var uploadInst = upload.render({
            elem: '#upload_video' //绑定元素
            ,url: '/tools/uploadFile' //上传接口
            ,data:{
                "type":"video",
                _xsrf:xsrf_token
            }
            ,done: function(res){
                $("#upload_video_url").attr("src", res.url);
                $("#upload_video_url").parent().show();
                $("input[name='url']").val(res.url);
            }
            ,error: function(){
                //请求异常回调
            }
        });
    });
</script>
